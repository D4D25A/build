"use strict";(()=>{var e={};e.id=87,e.ids=[87],e.modules={98860:e=>{e.exports=require("jsdom")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},96438:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>w,patchFetch:()=>N,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>v,staticGenerationAsyncStorage:()=>y});var n={};r.r(n),r.d(n,{DELETE:()=>h,GET:()=>p,PATCH:()=>f});var o=r(49303),a=r(88716),i=r(60670),s=r(87070),u=r(83493),l=r(50650),d=r(97453),c=r(75498);async function p(e,{params:t}){try{let r=new URL(e.url),n="true"===r.searchParams.get("includeCoupon"),o=(0,d.Vx)(t.id);if(!o)return s.NextResponse.json({success:!1,message:"Invalid order ID"},{status:400,headers:{"Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate",Pragma:"no-cache",Expires:"0"}});let a=await u._.order.findUnique({where:{id:o},include:n?{coupon:{select:{code:!0,discountType:!0,discountValue:!0}}}:void 0});if(!a)return s.NextResponse.json({success:!1,message:"Order not found"},{status:404});let i=a;if(n&&a.couponId&&!a.coupon){let e=await u._.coupon.findUnique({where:{id:a.couponId},select:{code:!0,discountType:!0,discountValue:!0}});e&&(i={...a,coupon:e})}return s.NextResponse.json({success:!0,order:i},{headers:{"Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate",Pragma:"no-cache",Expires:"0"}})}catch(e){return console.error("Error fetching order:",e),s.NextResponse.json({success:!1,message:"Error fetching order",error:e instanceof Error?e.message:"Unknown error"},{status:500,headers:{"Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate",Pragma:"no-cache",Expires:"0"}})}}async function f(e,{params:t}){try{let r=(0,d.Vx)(t.id);if(!r)return s.NextResponse.json({success:!1,message:"Invalid order ID"},{status:400});if(!await u._.order.findUnique({where:{id:r}}))return s.NextResponse.json({success:!1,message:"Order not found"},{status:404});let n=await e.json(),o={};if(void 0!==n.firstName){let e=(0,d.vJ)(n.firstName);e&&(o.firstName=e)}if(void 0!==n.middleName&&(o.middleName=n.middleName?(0,d.vJ)(n.middleName):null),void 0!==n.lastName){let e=(0,d.vJ)(n.lastName);e&&(o.lastName=e)}if(void 0!==n.dateOfBirth){let e=(0,d.DA)(n.dateOfBirth);e&&(o.dateOfBirth=e)}if(void 0!==n.sex){let e=(0,d.vJ)(n.sex);e&&(o.sex=e)}if(void 0!==n.eyeColor){let e=(0,d.vJ)(n.eyeColor);e&&(o.eyeColor=e)}if(void 0!==n.hairColor){let e=(0,d.vJ)(n.hairColor);e&&(o.hairColor=e)}if(void 0!==n.state){let e=(0,d.EY)(n.state);e&&(o.state=e)}if(void 0!==n.platform){let e=(0,d.yf)(n.platform);e&&(o.platform=e)}if(void 0!==n.username){let e=(0,d.oc)(n.username);e&&(o.username=e)}if(void 0!==n.email&&(o.email=n.email?(0,d.H3)(n.email):null),void 0!==n.wantEReceipt&&(o.wantEReceipt=(0,d.e7)(n.wantEReceipt)),void 0!==n.paymentMethod){let e=(0,d.eB)(n.paymentMethod);e&&(o.paymentMethod=e)}if(void 0!==n.hasPaid&&(o.hasPaid=(0,d.e7)(n.hasPaid)),void 0!==n.status){let e=(0,d.Gi)(n.status);e&&(o.status=e)}if(void 0!==n.passportPhotoUrl){let e=(0,d.dB)(n.passportPhotoUrl);if(e&&(0,c.h)(e)){let t=await (0,c.l)(e);o.passportPhotoUrl=t}else o.passportPhotoUrl=e}if(void 0!==n.signaturePhotoUrl){let e=(0,d.dB)(n.signaturePhotoUrl);if(e&&(0,c.h)(e)){let t=await (0,c.l)(e);o.signaturePhotoUrl=t}else o.signaturePhotoUrl=e}if(void 0!==n.price){let e=(0,d.Cd)(n.price);e&&(o.price=(0,l._)(e))}if(void 0!==n.height){let e=(0,d.Rz)(n.height);e&&(o.height=e)}if(void 0!==n.weight){let e=(0,d.Uw)(n.weight);e&&(o.weight=e)}o.updatedAt=new Date;let a=await u._.order.update({where:{id:r},data:o});return s.NextResponse.json({success:!0,order:a},{headers:{"Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate",Pragma:"no-cache",Expires:"0"}})}catch(e){return console.error("Error updating order:",e),s.NextResponse.json({success:!1,message:"Error updating order",error:e instanceof Error?e.message:"Unknown error"},{status:500,headers:{"Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate",Pragma:"no-cache",Expires:"0"}})}}async function h(e,{params:t}){try{let e=(0,d.Vx)(t.id);if(!e)return s.NextResponse.json({success:!1,message:"Invalid order ID"},{status:400});return await u._.order.delete({where:{id:e}}),s.NextResponse.json({success:!0,message:"Order deleted successfully"})}catch(e){return console.error("Error deleting order:",e),s.NextResponse.json({success:!1,message:"Error deleting order",error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/orders/[id]/route",pathname:"/api/orders/[id]",filename:"route",bundlePath:"app/api/orders/[id]/route"},resolvedPagePath:"/Users/kyleaditya/Documents/IDF coupon fulldetails/app/api/orders/[id]/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:g,staticGenerationAsyncStorage:y,serverHooks:v}=m,w="/api/orders/[id]/route";function N(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:y})}},75498:(e,t,r)=>{r.d(t,{l:()=>a,h:()=>i});let n=require("sharp");var o=r.n(n);async function a(e,t=80){try{let r=e.split(";base64,").pop();if(!r)throw Error("Invalid base64 string");let n=Buffer.from(r,"base64"),a=(await o()(n).webp({quality:t}).toBuffer()).toString("base64");return`data:image/webp;base64,${a}`}catch(t){return console.error("Error converting image to WebP:",t),e}}function i(e){if(!e||"string"!=typeof e)return!1;try{if(!e.startsWith("data:image/"))return!1;let[t,r]=e.split(",");if(!t||!r)return!1;return atob(r),!0}catch{return!1}}},83493:(e,t,r)=>{r.d(t,{_:()=>o});let n=require("@prisma/client"),o=globalThis.prisma??new n.PrismaClient},97453:(e,t,r)=>{r.d(t,{Cd:()=>c,DA:()=>p,EY:()=>m,Gi:()=>g,H3:()=>u,Rz:()=>C,Uw:()=>E,Vx:()=>h,Wx:()=>N,Yn:()=>w,Z6:()=>x,dB:()=>v,e7:()=>f,eB:()=>y,oc:()=>l,vJ:()=>s,yf:()=>d});var n=r(96468),o=r.n(n),a=r(61555),i=r.n(a);function s(e){return"string"!=typeof e?"":i().escape(e.trim())}function u(e){return"string"!=typeof e?"":i().normalizeEmail(e.trim().toLowerCase())||""}function l(e){return"string"!=typeof e?"":i().escape(e.trim()).replace(/[^a-zA-Z0-9_.-]/g,"")}function d(e){if("string"!=typeof e)return null;let t=e.trim();return"snapchat"===t.toLowerCase()?"Snapchat":"telegram"===t.toLowerCase()?"Telegram":null}function c(e){if("number"==typeof e)return e>0?Math.round(100*e)/100:null;if("string"==typeof e){let t=parseFloat(e);return!isNaN(t)&&t>0?Math.round(100*t)/100:null}return null}function p(e){if(e instanceof Date)return e;if("string"==typeof e){let t=new Date(e);return isNaN(t.getTime())?null:t}return null}function f(e){if("boolean"==typeof e)return e;if("string"==typeof e){let t=e.toLowerCase();return"true"===t||"1"===t||"yes"===t}return"number"==typeof e&&1===e}function h(e){if("string"!=typeof e)return null;let t=e.trim();return/^c[a-z0-9]{24}$/.test(t)?t:null}function m(e){if("string"!=typeof e)return null;let t=e.trim();return["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"].includes(t)?t:null}function g(e){if("string"!=typeof e)return null;let t=e.trim().toUpperCase();return["RECEIVED","PROCESSING","IN_PRODUCTION","IN_TRANSIT","DELIVERED","CANCELLED"].includes(t)?t:null}function y(e){return"string"!=typeof e?null:e.trim()||null}function v(e){if("string"!=typeof e)return null;let t=e.trim();if(!t.startsWith("data:image/"))return null;let[r,n]=t.split(",");if(!r||!n)return null;try{return atob(n),t}catch{return null}}function w(e){if("string"!=typeof e)return null;let t=e.trim().toUpperCase();return["ADMIN","USER"].includes(t)?t:null}function N(e){if("string"!=typeof e)return null;let t=e.trim().toUpperCase();return["INFO","FAQ","PRIVACY"].includes(t)?t:null}function x(e){return"string"!=typeof e?"":o().sanitize(e.trim())}function C(e){if("string"!=typeof e)return null;let t=e.trim();return/^[4-6]'(?:10|11|[0-9])"$/.test(t)?t:null}function E(e){if("number"==typeof e)return e>=50&&e<=500?Math.round(e):null;if("string"==typeof e){let t=parseInt(e,10);return!isNaN(t)&&t>=50&&t<=500?t:null}return null}},50650:(e,t,r)=>{function n(){let e=Date.now().toString(),t=Math.floor(1e3*Math.random()).toString().padStart(3,"0");return`KID${e}${t}`}function o(e){return Math.round(100*e)/100}r.d(t,{_:()=>o,m:()=>n})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[9276,5972,3556],()=>r(96438));module.exports=n})();