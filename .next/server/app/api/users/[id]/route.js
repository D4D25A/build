"use strict";(()=>{var e={};e.id=1380,e.ids=[1380],e.modules={98860:e=>{e.exports=require("jsdom")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},71973:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>w,requestAsyncStorage:()=>f,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h});var s={};r.r(s),r.d(s,{DELETE:()=>d});var n=r(49303),i=r(88716),o=r(60670),a=r(87070),u=r(75571),l=r(95021),c=r(83493),p=r(97453);async function d(e,{params:t}){try{let e=await (0,u.getServerSession)(l.authOptions);if(!e||"ADMIN"!==e.user.role)return a.NextResponse.json({success:!1,message:"Unauthorized"},{status:401});let r=(0,p.Vx)(t.id);if(!r)return a.NextResponse.json({success:!1,message:"Invalid user ID"},{status:400});if(e.user.id===r)return a.NextResponse.json({success:!1,message:"Cannot delete your own account"},{status:400});return await c._.user.delete({where:{id:r}}),a.NextResponse.json({success:!0,message:"User deleted successfully"})}catch(e){return console.error("Error deleting user:",e),a.NextResponse.json({success:!1,message:"Error deleting user",error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let m=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/users/[id]/route",pathname:"/api/users/[id]",filename:"route",bundlePath:"app/api/users/[id]/route"},resolvedPagePath:"/Users/kyleaditya/Documents/IDF coupon fulldetails/app/api/users/[id]/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:h,serverHooks:g}=m,y="/api/users/[id]/route";function w(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}},95021:(e,t,r)=>{r.r(t),r.d(t,{GET:()=>d,POST:()=>d,authOptions:()=>p});var s=r(75571),n=r.n(s),i=r(53797),o=r(42023),a=r.n(o),u=r(83493);class l{constructor(e=6e4,t=5,r=9e5){this.store=new Map,this.windowSize=e,this.maxAttempts=t,this.blockDuration=r}checkRateLimit(e){let t=Date.now(),r=this.store.get(e);if(.1>Math.random()&&this.cleanup(t),!r)return this.store.set(e,{count:1,timestamp:t,blocked:!1}),{blocked:!1};if(r.blocked){if(r.blockExpires&&t>=r.blockExpires)return this.store.set(e,{count:1,timestamp:t,blocked:!1}),{blocked:!1};let s=Math.ceil((r.blockExpires-t)/1e3);return{blocked:!0,message:`Too many login attempts. Please try again in ${s} seconds.`}}return t-r.timestamp>this.windowSize?(this.store.set(e,{count:1,timestamp:t,blocked:!1}),{blocked:!1}):(r.count+=1,r.count>this.maxAttempts)?(r.blocked=!0,r.blockExpires=t+this.blockDuration,this.store.set(e,r),{blocked:!0,message:`Too many login attempts. Please try again in ${this.blockDuration/1e3} seconds.`}):(this.store.set(e,r),{blocked:!1})}cleanup(e){for(let[t,r]of this.store.entries())(r.blocked&&e>=(r.blockExpires||0)||!r.blocked&&e-r.timestamp>this.windowSize)&&this.store.delete(t)}}let c=new l,p={providers:[(0,i.Z)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"},remember:{label:"Remember me",type:"boolean"}},async authorize(e,t){if(!e?.email||!e?.password)throw Error("Please enter an email and password");let r=(t?.headers?.["x-forwarded-for"]||"").split(",")[0].trim()||"unknown",s=c.checkRateLimit(r);if(s.blocked)throw Error(s.message||"Too many login attempts");let n=await u._.user.findUnique({where:{email:e.email}});if(!n)throw Error("No user found");if(!await a().compare(e.password,n.password))throw Error("Invalid password");return{id:n.id,email:n.email,name:n.name,role:n.role}}})],callbacks:{jwt:async({token:e,user:t})=>(t&&(e.role=t.role,e.id=t.id),e),session:async({session:e,token:t})=>(e?.user&&(e.user.role=t.role,e.user.id=t.id),e)},pages:{signIn:"/admin"},session:{strategy:"jwt",maxAge:2592e3},secret:process.env.NEXTAUTH_SECRET},d=n()(p)},83493:(e,t,r)=>{r.d(t,{_:()=>n});let s=require("@prisma/client"),n=globalThis.prisma??new s.PrismaClient},97453:(e,t,r)=>{r.d(t,{Cd:()=>p,DA:()=>d,EY:()=>h,Gi:()=>g,H3:()=>u,Rz:()=>E,Uw:()=>N,Vx:()=>f,Wx:()=>b,Yn:()=>x,Z6:()=>k,dB:()=>w,e7:()=>m,eB:()=>y,oc:()=>l,vJ:()=>a,yf:()=>c});var s=r(96468),n=r.n(s),i=r(61555),o=r.n(i);function a(e){return"string"!=typeof e?"":o().escape(e.trim())}function u(e){return"string"!=typeof e?"":o().normalizeEmail(e.trim().toLowerCase())||""}function l(e){return"string"!=typeof e?"":o().escape(e.trim()).replace(/[^a-zA-Z0-9_.-]/g,"")}function c(e){if("string"!=typeof e)return null;let t=e.trim();return"snapchat"===t.toLowerCase()?"Snapchat":"telegram"===t.toLowerCase()?"Telegram":null}function p(e){if("number"==typeof e)return e>0?Math.round(100*e)/100:null;if("string"==typeof e){let t=parseFloat(e);return!isNaN(t)&&t>0?Math.round(100*t)/100:null}return null}function d(e){if(e instanceof Date)return e;if("string"==typeof e){let t=new Date(e);return isNaN(t.getTime())?null:t}return null}function m(e){if("boolean"==typeof e)return e;if("string"==typeof e){let t=e.toLowerCase();return"true"===t||"1"===t||"yes"===t}return"number"==typeof e&&1===e}function f(e){if("string"!=typeof e)return null;let t=e.trim();return/^c[a-z0-9]{24}$/.test(t)?t:null}function h(e){if("string"!=typeof e)return null;let t=e.trim();return["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"].includes(t)?t:null}function g(e){if("string"!=typeof e)return null;let t=e.trim().toUpperCase();return["RECEIVED","PROCESSING","IN_PRODUCTION","IN_TRANSIT","DELIVERED","CANCELLED"].includes(t)?t:null}function y(e){return"string"!=typeof e?null:e.trim()||null}function w(e){if("string"!=typeof e)return null;let t=e.trim();if(!t.startsWith("data:image/"))return null;let[r,s]=t.split(",");if(!r||!s)return null;try{return atob(s),t}catch{return null}}function x(e){if("string"!=typeof e)return null;let t=e.trim().toUpperCase();return["ADMIN","USER"].includes(t)?t:null}function b(e){if("string"!=typeof e)return null;let t=e.trim().toUpperCase();return["INFO","FAQ","PRIVACY"].includes(t)?t:null}function k(e){return"string"!=typeof e?"":n().sanitize(e.trim())}function E(e){if("string"!=typeof e)return null;let t=e.trim();return/^[4-6]'(?:10|11|[0-9])"$/.test(t)?t:null}function N(e){if("number"==typeof e)return e>=50&&e<=500?Math.round(e):null;if("string"==typeof e){let t=parseInt(e,10);return!isNaN(t)&&t>=50&&t<=500?t:null}return null}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,5972,7313,3556],()=>r(71973));module.exports=s})();