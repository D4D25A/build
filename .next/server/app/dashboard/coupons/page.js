(()=>{var e={};e.id=4762,e.ids=[4762],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},62207:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),t(50871),t(13321),t(84752),t(35866);var a=t(23191),n=t(88716),l=t(37922),o=t.n(l),r=t(95231),i={};for(let e in r)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>r[e]);t.d(s,i);let d=["",{children:["dashboard",{children:["coupons",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,50871)),"/Users/kyleaditya/Documents/IDF coupon fulldetails/app/dashboard/coupons/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,13321)),"/Users/kyleaditya/Documents/IDF coupon fulldetails/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,84752)),"/Users/kyleaditya/Documents/IDF coupon fulldetails/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/kyleaditya/Documents/IDF coupon fulldetails/app/dashboard/coupons/page.tsx"],u="/dashboard/coupons/page",x={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/dashboard/coupons/page",pathname:"/dashboard/coupons",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},91778:(e,s,t)=>{Promise.resolve().then(t.bind(t,60423))},88766:(e,s,t)=>{Promise.resolve().then(t.bind(t,58767))},60423:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var a=t(10326),n=t(17577),l=t(35047),o=t(90772),r=t(54432),i=t(34474),d=t(33071),c=t(62288),u=t(55632),x=t(74723),p=t(98181),m=t(9346),h=t(30811),j=t(37388),f=t(62881);let g=(0,f.Z)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),y=(0,f.Z)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);var N=t(77863),v=t(85999);function b(){(0,l.useRouter)();let[e,s]=(0,n.useState)([]),[t,f]=(0,n.useState)(!1),[b,C]=(0,n.useState)(!1),[w,P]=(0,n.useState)(null),E=(0,x.cI)({defaultValues:{code:"",discountType:"PERCENTAGE",discountValue:0,expiresAt:null,usageLimit:null}}),A=async()=>{try{let e=await fetch("/api/coupons"),t=await e.json();t.success&&s(t.coupons)}catch(e){console.error("Error fetching coupons:",e),v.Am.error("Failed to fetch coupons")}},k=async e=>{try{let s={...e,discountValue:parseFloat(e.discountValue),usageLimit:e.usageLimit?parseInt(e.usageLimit):null},t=await fetch("/api/coupons",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),a=await t.json();a.success?(v.Am.success("Coupon created successfully"),f(!1),E.reset(),A()):v.Am.error(a.error||"Failed to create coupon")}catch(e){console.error("Error creating coupon:",e),v.Am.error("Failed to create coupon")}},D=async e=>{if(w)try{let s={...e,discountValue:parseFloat(e.discountValue),usageLimit:e.usageLimit?parseInt(e.usageLimit):null},t=await fetch("/api/coupons",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,id:w.id})}),a=await t.json();a.success?(v.Am.success("Coupon updated successfully"),C(!1),P(null),E.reset(),A()):v.Am.error(a.error||"Failed to update coupon")}catch(e){console.error("Error updating coupon:",e),v.Am.error("Failed to update coupon")}},I=async e=>{if(confirm("Are you sure you want to delete this coupon?"))try{let s=await fetch(`/api/coupons?id=${e}`,{method:"DELETE"}),t=await s.json();t.success?(v.Am.success("Coupon deleted successfully"),A()):v.Am.error(t.error||"Failed to delete coupon")}catch(e){console.error("Error deleting coupon:",e),v.Am.error("Failed to delete coupon")}},F=e=>{P(e),E.reset({code:e.code,discountType:e.discountType,discountValue:e.discountValue,expiresAt:e.expiresAt?new Date(e.expiresAt):null,usageLimit:e.usageLimit}),C(!0)};return(0,a.jsxs)("div",{className:"container mx-auto py-10",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Coupons"}),(0,a.jsxs)(c.Vq,{open:t,onOpenChange:f,children:[a.jsx(c.hg,{asChild:!0,children:a.jsx(o.z,{children:"Add Coupon"})}),(0,a.jsxs)(c.cZ,{children:[(0,a.jsxs)(c.fK,{children:[a.jsx(c.$N,{children:"Add New Coupon"}),a.jsx(c.Be,{children:"Create a new coupon code with specific discount settings."})]}),a.jsx(u.l0,{...E,children:(0,a.jsxs)("form",{onSubmit:E.handleSubmit(k),className:"space-y-4",children:[a.jsx(u.Wi,{control:E.control,name:"code",render:({field:e})=>(0,a.jsxs)(u.xJ,{children:[a.jsx(u.lX,{children:"Coupon Code"}),a.jsx(u.NI,{children:a.jsx(r.I,{...e,placeholder:"SUMMER2024"})}),a.jsx(u.zG,{})]})}),a.jsx(u.Wi,{control:E.control,name:"discountType",render:({field:e})=>(0,a.jsxs)(u.xJ,{children:[a.jsx(u.lX,{children:"Discount Type"}),(0,a.jsxs)(i.Ph,{onValueChange:e.onChange,defaultValue:e.value,children:[a.jsx(u.NI,{children:a.jsx(i.i4,{children:a.jsx(i.ki,{placeholder:"Select discount type"})})}),(0,a.jsxs)(i.Bw,{children:[a.jsx(i.Ql,{value:"PERCENTAGE",children:"Percentage Off"}),a.jsx(i.Ql,{value:"FIXED_AMOUNT",children:"Fixed Amount Off"}),a.jsx(i.Ql,{value:"FIXED_PRICE",children:"Fixed Price"})]})]}),a.jsx(u.zG,{})]})}),a.jsx(u.Wi,{control:E.control,name:"discountValue",render:({field:e})=>(0,a.jsxs)(u.xJ,{children:[a.jsx(u.lX,{children:"Discount Value"}),a.jsx(u.NI,{children:a.jsx(r.I,{...e,type:"number",min:0,step:.01})}),a.jsx(u.pf,{children:"PERCENTAGE"===E.watch("discountType")?"Enter percentage (0-100)":"Enter amount in dollars"}),a.jsx(u.zG,{})]})}),a.jsx(u.Wi,{control:E.control,name:"expiresAt",render:({field:e})=>(0,a.jsxs)(u.xJ,{className:"flex flex-col",children:[a.jsx(u.lX,{children:"Expiration Date (Optional)"}),(0,a.jsxs)(h.J2,{children:[a.jsx(h.xo,{asChild:!0,children:a.jsx(u.NI,{children:(0,a.jsxs)(o.z,{variant:"outline",className:(0,N.cn)("w-full pl-3 text-left font-normal",!e.value&&"text-muted-foreground"),children:[e.value?(0,p.WU)(e.value,"PPP"):a.jsx("span",{children:"Pick a date"}),a.jsx(j.Z,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),a.jsx(h.yk,{className:"w-auto p-0",align:"start",children:a.jsx(m.f,{mode:"single",selected:e.value||void 0,onSelect:e.onChange,disabled:e=>e<new Date,initialFocus:!0})})]}),a.jsx(u.zG,{})]})}),a.jsx(u.Wi,{control:E.control,name:"usageLimit",render:({field:{onChange:e,value:s,...t}})=>(0,a.jsxs)(u.xJ,{children:[a.jsx(u.lX,{children:"Usage Limit (Optional)"}),a.jsx(u.NI,{children:a.jsx(r.I,{type:"number",min:1,placeholder:"Leave empty for unlimited uses",onChange:s=>{e(s.target.value?parseInt(s.target.value):null)},value:null===s?"":s,...t})}),a.jsx(u.pf,{children:"Maximum number of times this coupon can be used"}),a.jsx(u.zG,{})]})}),a.jsx(c.cN,{children:a.jsx(o.z,{type:"submit",children:"Create Coupon"})})]})})]})]})]}),a.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map(e=>(0,a.jsxs)(d.Zb,{children:[(0,a.jsxs)(d.Ol,{children:[(0,a.jsxs)(d.ll,{className:"flex justify-between items-center",children:[a.jsx("span",{children:e.code}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(o.z,{variant:"ghost",size:"icon",onClick:()=>F(e),children:a.jsx(g,{className:"h-4 w-4"})}),a.jsx(o.z,{variant:"ghost",size:"icon",onClick:()=>I(e.id),children:a.jsx(y,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)(d.SZ,{children:["PERCENTAGE"===e.discountType?`${e.discountValue}% off`:"FIXED_AMOUNT"===e.discountType?`$${e.discountValue} off`:`Fixed price: $${e.discountValue}`,null!==e.usageLimit&&(0,a.jsxs)("div",{className:"mt-1 text-sm",children:[(0,a.jsxs)("span",{className:`${(e.usageCount||0)>=(e.usageLimit||0)?"text-red-500":"text-green-500"}`,children:[e.usageCount||0," used"]}),` / ${e.usageLimit} limit`]}),null===e.usageLimit&&(e.usageCount||0)>0&&(0,a.jsxs)("div",{className:"mt-1 text-sm",children:["Used ",e.usageCount||0," times (unlimited)"]})]})]}),a.jsx(d.aY,{children:(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.expiresAt?(0,a.jsxs)("p",{children:["Expires: ",(0,p.WU)(new Date(e.expiresAt),"PPP")]}):a.jsx("p",{children:"No expiration date"}),(0,a.jsxs)("p",{children:["Status: ",e.isEnabled?"Active":"Disabled"]})]})})]},e.id))}),a.jsx(c.Vq,{open:b,onOpenChange:C,children:(0,a.jsxs)(c.cZ,{children:[(0,a.jsxs)(c.fK,{children:[a.jsx(c.$N,{children:"Edit Coupon"}),a.jsx(c.Be,{children:"Modify the coupon code settings."})]}),a.jsx(u.l0,{...E,children:(0,a.jsxs)("form",{onSubmit:E.handleSubmit(D),className:"space-y-4",children:[a.jsx(u.Wi,{control:E.control,name:"code",render:({field:e})=>(0,a.jsxs)(u.xJ,{children:[a.jsx(u.lX,{children:"Coupon Code"}),a.jsx(u.NI,{children:a.jsx(r.I,{...e})}),a.jsx(u.zG,{})]})}),a.jsx(u.Wi,{control:E.control,name:"discountType",render:({field:e})=>(0,a.jsxs)(u.xJ,{children:[a.jsx(u.lX,{children:"Discount Type"}),(0,a.jsxs)(i.Ph,{onValueChange:e.onChange,defaultValue:e.value,children:[a.jsx(u.NI,{children:a.jsx(i.i4,{children:a.jsx(i.ki,{})})}),(0,a.jsxs)(i.Bw,{children:[a.jsx(i.Ql,{value:"PERCENTAGE",children:"Percentage Off"}),a.jsx(i.Ql,{value:"FIXED_AMOUNT",children:"Fixed Amount Off"}),a.jsx(i.Ql,{value:"FIXED_PRICE",children:"Fixed Price"})]})]}),a.jsx(u.zG,{})]})}),a.jsx(u.Wi,{control:E.control,name:"discountValue",render:({field:e})=>(0,a.jsxs)(u.xJ,{children:[a.jsx(u.lX,{children:"Discount Value"}),a.jsx(u.NI,{children:a.jsx(r.I,{...e,type:"number",min:0,step:.01})}),a.jsx(u.pf,{children:"PERCENTAGE"===E.watch("discountType")?"Enter percentage (0-100)":"Enter amount in dollars"}),a.jsx(u.zG,{})]})}),a.jsx(u.Wi,{control:E.control,name:"expiresAt",render:({field:e})=>(0,a.jsxs)(u.xJ,{className:"flex flex-col",children:[a.jsx(u.lX,{children:"Expiration Date (Optional)"}),(0,a.jsxs)(h.J2,{children:[a.jsx(h.xo,{asChild:!0,children:a.jsx(u.NI,{children:(0,a.jsxs)(o.z,{variant:"outline",className:(0,N.cn)("w-full pl-3 text-left font-normal",!e.value&&"text-muted-foreground"),children:[e.value?(0,p.WU)(e.value,"PPP"):a.jsx("span",{children:"Pick a date"}),a.jsx(j.Z,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),a.jsx(h.yk,{className:"w-auto p-0",align:"start",children:a.jsx(m.f,{mode:"single",selected:e.value||void 0,onSelect:e.onChange,disabled:e=>e<new Date,initialFocus:!0})})]}),a.jsx(u.zG,{})]})}),a.jsx(u.Wi,{control:E.control,name:"usageLimit",render:({field:{onChange:e,value:s,...t}})=>(0,a.jsxs)(u.xJ,{children:[a.jsx(u.lX,{children:"Usage Limit (Optional)"}),a.jsx(u.NI,{children:a.jsx(r.I,{type:"number",min:1,placeholder:"Leave empty for unlimited uses",onChange:s=>{e(s.target.value?parseInt(s.target.value):null)},value:null===s?"":s,...t})}),a.jsx(u.pf,{children:"Maximum number of times this coupon can be used"}),a.jsx(u.zG,{})]})}),a.jsx(c.cN,{children:a.jsx(o.z,{type:"submit",children:"Update Coupon"})})]})})]})})]})}},58767:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o}),t(10326);var a=t(17577),n=t(77109),l=t(35047);function o({children:e}){let{data:s}=(0,n.useSession)();(0,l.useRouter)(),(0,l.usePathname)();let[t,o]=(0,a.useState)(!0);return null}t(90434),t(46226),t(90772),t(94019),t(90748)},33071:(e,s,t)=>{"use strict";t.d(s,{Ol:()=>r,SZ:()=>d,Zb:()=>o,aY:()=>c,ll:()=>i});var a=t(10326),n=t(17577),l=t(77863);let o=n.forwardRef(({className:e,...s},t)=>a.jsx("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));o.displayName="Card";let r=n.forwardRef(({className:e,...s},t)=>a.jsx("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",e),...s}));r.displayName="CardHeader";let i=n.forwardRef(({className:e,...s},t)=>a.jsx("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));i.displayName="CardTitle";let d=n.forwardRef(({className:e,...s},t)=>a.jsx("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",e),...s}));d.displayName="CardDescription";let c=n.forwardRef(({className:e,...s},t)=>a.jsx("div",{ref:t,className:(0,l.cn)("p-6 pt-0",e),...s}));c.displayName="CardContent",n.forwardRef(({className:e,...s},t)=>a.jsx("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter"},62288:(e,s,t)=>{"use strict";t.d(s,{$N:()=>h,Be:()=>j,Vq:()=>i,cN:()=>m,cZ:()=>x,fK:()=>p,hg:()=>d});var a=t(10326),n=t(17577),l=t(98958),o=t(94019),r=t(77863);let i=l.fC,d=l.xz,c=l.h_;l.x8;let u=n.forwardRef(({className:e,...s},t)=>a.jsx(l.aV,{ref:t,className:(0,r.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s}));u.displayName=l.aV.displayName;let x=n.forwardRef(({className:e,children:s,...t},n)=>(0,a.jsxs)(c,{children:[a.jsx(u,{}),(0,a.jsxs)(l.VY,{ref:n,className:(0,r.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t,children:[s,(0,a.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(o.Z,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));x.displayName=l.VY.displayName;let p=({className:e,...s})=>a.jsx("div",{className:(0,r.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...s});p.displayName="DialogHeader";let m=({className:e,...s})=>a.jsx("div",{className:(0,r.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});m.displayName="DialogFooter";let h=n.forwardRef(({className:e,...s},t)=>a.jsx(l.Dx,{ref:t,className:(0,r.cn)("text-lg font-semibold leading-none tracking-tight",e),...s}));h.displayName=l.Dx.displayName;let j=n.forwardRef(({className:e,...s},t)=>a.jsx(l.dk,{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",e),...s}));j.displayName=l.dk.displayName},90748:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(62881).Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])},50871:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/kyleaditya/Documents/IDF coupon fulldetails/app/dashboard/coupons/page.tsx#default`)},13321:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(68570).createProxy)(String.raw`/Users/kyleaditya/Documents/IDF coupon fulldetails/app/dashboard/layout.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[9276,5015,9308,434,739,8181,1359,604,341,6821],()=>t(62207));module.exports=a})();